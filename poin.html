<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#4A0A13" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>Poin â€” Beloved Kids Cito</title>
  <link rel="icon" type="image/x-icon" href="BK Cito.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Playfair+Display:ital,wght@0,700;0,800;1,700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="poin.css" />
</head>
<body>

  <div class="bg-bubbles" aria-hidden="true">
    <span></span><span></span><span></span><span></span><span></span>
  </div>

  <!-- LOADING -->
  <div class="loading-overlay" id="loadingOverlay" role="status" aria-live="polite">
    <div class="loading-spinner"></div>
    <p id="loadingMsg">Memuat data...</p>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast" role="alert" aria-live="assertive"></div>

  <!-- HEADER -->
  <header class="site-header">
    <div class="header-inner">
      <div class="logo-wrap">
        <img src="BK Cito.jpeg" alt="Beloved Kids Cito" class="site-logo" />
      </div>
      <div class="header-text">
        <div class="header-date" id="headerDate"></div>
        <h1 class="header-title">Beloved Kids Cito</h1>
        <p class="header-tagline">Sistem Poin Jemaat Anak</p>
      </div>
    </div>
    <div class="header-ring" aria-hidden="true"></div>
  </header>

  <!-- MAIN -->
  <main class="main-content">

    <!-- NAV BALIK -->
    <div class="back-bar">
      <a href="index.html" class="back-btn">&#8592; Absensi</a>
      <div class="year-badge" id="yearBadge"></div>
    </div>

    <!-- TAB KELAS -->
    <nav class="tab-nav" role="tablist" aria-label="Pilih Kelas">
      <button class="tab-btn active" id="ptab-semua" role="tab" onclick="switchPoinTab('semua')">
        <span class="tab-icon">ğŸ†</span>
        <span class="tab-label">Semua</span>
        <span class="tab-sub">All Kelas</span>
      </button>
      <button class="tab-btn" id="ptab-kecil"  role="tab" onclick="switchPoinTab('kecil')">
        <span class="tab-icon">ğŸ£</span>
        <span class="tab-label">Kecil</span>
        <span class="tab-sub">3â€“6 thn</span>
      </button>
      <button class="tab-btn" id="ptab-tengah" role="tab" onclick="switchPoinTab('tengah')">
        <span class="tab-icon">ğŸŒ¿</span>
        <span class="tab-label">Tengah</span>
        <span class="tab-sub">7â€“9 thn</span>
      </button>
      <button class="tab-btn" id="ptab-besar"  role="tab" onclick="switchPoinTab('besar')">
        <span class="tab-icon">â­</span>
        <span class="tab-label">Besar</span>
        <span class="tab-sub">10+ thn</span>
      </button>
    </nav>

    <!-- PANEL per kelas -->
    <div id="poin-panel" class="poin-panel-wrap">
      <!-- Dirender oleh JS -->
    </div>

  </main>

  <!-- MODAL: BERI POIN -->
  <div class="modal-overlay" id="poinModal" onclick="if(event.target===this)closePoinModal()">
    <div class="modal-box poin-modal-box">
      <div class="modal-header">
        <div class="poin-modal-avatar" id="poinModal-avatar"></div>
        <div>
          <h3 class="modal-title" id="poinModal-nama"></h3>
          <p class="modal-sub">Total poin: <strong id="poinModal-total"></strong></p>
        </div>
        <button class="modal-close" onclick="closePoinModal()">âœ•</button>
      </div>

      <p class="poin-modal-label">Pilih aktivitas (bisa lebih dari satu):</p>
      <div class="aktivitas-grid" id="aktivitasGrid">
        <!-- Dirender JS -->
      </div>

      <!-- Submit bar aktivitas -->
      <div class="poin-submit-bar" id="poinSubmitBar">
        <span class="poin-submit-info">
          <span id="poinSubmitCount">0</span> aktivitas dipilih
        </span>
        <button class="btn btn-primary poin-submit-btn" onclick="submitAktivitasPoin()">
          Tambah Poin
        </button>
      </div>


    </div>
  </div>

  <!-- MODAL: KONFIRMASI RESET -->
  <div class="modal-overlay" id="resetModal" onclick="if(event.target===this)closeResetModal()">
    <div class="modal-box confirm-modal-box">
      <div class="confirm-icon-wrap">ğŸ”„</div>
      <h3 class="confirm-title">Reset Poin <span id="resetModal-tahun"></span>?</h3>
      <div class="confirm-body">
        Semua poin anak di <strong>seluruh kelas</strong> akan direset ke 0.<br><br>
        Riwayat poin tahun ini akan disimpan di sheet <strong>Poin_Arsip</strong> sebelum direset.
      </div>
      <div class="confirm-actions">
        <button class="btn btn-ghost" onclick="closeResetModal()">Batal</button>
        <button class="btn btn-danger" onclick="doResetPoin()" style="min-height:50px;flex:1.6">Reset Sekarang</button>
      </div>
    </div>
  </div>

  <script src="poin.js"></script>
</body>
</html>